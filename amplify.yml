version: 1
applications:
 - appRoot: apps/todo-app-amplify-gen-2
   frontend:
     phases:
       preBuild:
         commands:
           - nvm use $VERSION_NODE_18
           - npm ci
       build:
         commands:
           - npm run build-app
     artifacts:
       baseDirectory:
         dist/apps/todo-app-amplify-gen-2
       files:
         - '**/*'
     cache:
       paths:
         - node_modules/**/*
     buildPath: /
backend:
  phases:
    build:
      commands:
        - cd apps/
        - npx ampx pipeline-deploy --branch $AWS_BRANCH --app-id $AWS_APP_ID
